package evm_test

import (
	"encoding/hex"
	"fmt"
	"strings"
	"testing"

	"github.com/scalarorg/relayers/pkg/clients/evm"
	"github.com/stretchr/testify/assert"
	"github.com/stretchr/testify/require"
)

var (
	executeData1         = "09c5eabe000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000008c00000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000058000000000000000000000000000000000000000000000000000000000000005200000000000000000000000000000000000000000000000000000000000aa36a7000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000001c000000000000000000000000000000000000000000000000000000000000000024b6f70ea9c9556453ab0f8b65003118239719ae504bd19559f21e0f3c5021479bac7d491529a703e5af3336c32ff64b73b0cd0ed25cc61a43567b25741dde8b60000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000013617070726f7665436f6e747261637443616c6c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000013617070726f7665436f6e747261637443616c6c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000001c0000000000000000000000000000000000000000000000000000000000000016000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000001000000000000000000000000001f98c06d8734d5a9ff0b53e3294626e62e4d232c2ccb86603d404ee7a1982d7dddce2416aa1e334808027e85a574fd4beb642d457c1b7e6978cb930a0e42b632773e564be64eb64da491aee447a4fa836ead8a0400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010626974636f696e2d746573746e65743400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002a30783133304334383130443537313430653145363239363763424637343243614561453931623665634500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000016000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000001000000000000000000000000001f98c06d8734d5a9ff0b53e3294626e62e4d232c70859da59f66b872df9495245c3f69a35137d3a7b7ef7b255557e3d3065c95a3a1c6f8acb05f02085139c3cd4a16c18edc55fa36cc49551c4caf611ce3f37daa00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010626974636f696e2d746573746e65743400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002a30783133304334383130443537313430653145363239363763424637343243614561453931623665634500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000032000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000120000000000000000000000000000000000000000000000000000000000000ea6000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000000004000000000000000000000000475bd32787373ab356f5173c43860ee84c52d9bb0000000000000000000000006bac56260cc1f884ead16213645b7b57b57593a90000000000000000000000008ee0054a5a803e37d7773892bcdcc9bafeb766d7000000000000000000000000c45cffd93ab6d2c7229b4e3c4ce46fe242aa740f00000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000004e20000000000000000000000000000000000000000000000000000000000000753000000000000000000000000000000000000000000000000000000000000027100000000000000000000000000000000000000000000000000000000000009c400000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000000417f5509eebd9222503b3ade3e0cb7b508a46eb700e2057e7887d0de00d3e2cc3c72cd359535cf67cd59592e0fc976578794bd5395092694e4034023493a22987e1c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000041b086cf93f7957a084380f7e911cc6e28885eec7c6132c3d19a865ffc2f6188991bacb2ca81c66bbd294e9372d6bd82a6841a833a4ec6590270fd8e6c79aa6bf81b00000000000000000000000000000000000000000000000000000000000000"
	executeData2         = "09c5eabe000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000006a00000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000036000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000000011232a596e9a96bdea93cecf444ecd9a3ec227d278f6dd8ef346758d2d0f54229000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000013617070726f7665436f6e747261637443616c6c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000016000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000b5ee0d2ebb24841fbadc76a6196cd01f78903b636404b3cb3f3a521527a4361a91cc3c9cfdab0523d5217430273cd9dde9abe9afbb243ff34c94f3af9a43b2de00000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000010657468657265756d2d7365706f6c696100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002a30784239316533413845663836323536373032366436463337366339463364366238313443613433333700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000032000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000120000000000000000000000000000000000000000000000000000000000000ea6000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000000004000000000000000000000000057cc688a7a0336897a315e38643e42ec207e2090000000000000000000000000e942c5e30adf86f844339850c5791355efd3d95000000000000000000000000a2ffff8288c4ee3bce7b26816fc606b403aca185000000000000000000000000bc57d589b69d26d6e64a9aec17eb35fbb5b158bc00000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000009c400000000000000000000000000000000000000000000000000000000000004e20000000000000000000000000000000000000000000000000000000000000271000000000000000000000000000000000000000000000000000000000000075300000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000000413f339fb7bcef84ae966ddd7eac39bd56934ffe438613728d69c93168633f5d537b2fc29f17e25e2e84da7b702081bc45e97fe2dc8d58be8150585a15a56a56eb1b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000041ac92856c6b90a7df861c466fd0b86298fa544af1a36b173df6c2737eaaa2125d64599e6c9df173a2e9dff2331aa2034d0ba742334dbf83c4bed19cccd48889431b00000000000000000000000000000000000000000000000000000000000000"
	executeData          = "09c5eabe00000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000ae0000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000007a000000000000000000000000000000000000000000000000000000000000007400000000000000000000000000000000000000000000000000000000000aa36a700000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000024000000000000000000000000000000000000000000000000000000000000000034b6f70ea9c9556453ab0f8b65003118239719ae504bd19559f21e0f3c5021479bac7d491529a703e5af3336c32ff64b73b0cd0ed25cc61a43567b25741dde8b6f68541762276895b200060168ccdf90abb8c621b0229739b9f1dc9b1903e20aa0000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e00000000000000000000000000000000000000000000000000000000000000013617070726f7665436f6e747261637443616c6c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000013617070726f7665436f6e747261637443616c6c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000013617070726f7665436f6e747261637443616c6c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000001e00000000000000000000000000000000000000000000000000000000000000360000000000000000000000000000000000000000000000000000000000000016000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000001000000000000000000000000001f98c06d8734d5a9ff0b53e3294626e62e4d232c2ccb86603d404ee7a1982d7dddce2416aa1e334808027e85a574fd4beb642d457c1b7e6978cb930a0e42b632773e564be64eb64da491aee447a4fa836ead8a0400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010626974636f696e2d746573746e65743400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002a30783133304334383130443537313430653145363239363763424637343243614561453931623665634500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000016000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000001000000000000000000000000001f98c06d8734d5a9ff0b53e3294626e62e4d232c70859da59f66b872df9495245c3f69a35137d3a7b7ef7b255557e3d3065c95a3a1c6f8acb05f02085139c3cd4a16c18edc55fa36cc49551c4caf611ce3f37daa00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010626974636f696e2d746573746e65743400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002a30783133304334383130443537313430653145363239363763424637343243614561453931623665634500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000016000000000000000000000000000000000000000000000000000000000000000c00000000000000000000000000000000000000000000000000000000000000100000000000000000000000000b91e3a8ef862567026d6f376c9f3d6b814ca43373542e25e3fe2e4082f9dff6769222d2a40b67eafe49660fd7edb26fffdfdab177061fd3d540a3e43f3ea5026d591ec927e13b5918d1e8d6b3c13f33faad09c1800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010626974636f696e2d746573746e65743400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002a30783234613164423537466133656341466362614439316436456630363834333961634565416530393000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000032000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000120000000000000000000000000000000000000000000000000000000000000ea6000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000000004000000000000000000000000324a5f8ff56f04a99f6af55a5de23e4f48901b7200000000000000000000000048a200f5cc43494e98b862f78ddf839ada5e08550000000000000000000000006c8a7a322bb78b4c209aa6e3713f30f5ea95a94c000000000000000000000000c28881f4cc390ad5484f008ee2c3374754160a9d00000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000009c4000000000000000000000000000000000000000000000000000000000000075300000000000000000000000000000000000000000000000000000000000004e2000000000000000000000000000000000000000000000000000000000000027100000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000c00000000000000000000000000000000000000000000000000000000000000041010be80802ab74ed3eb607339edf2c126d194d41acf6d170f34fd2dab83f75a86c636a79a0a5a7fddfb24c2410f6cb34bf7549e268856766c7238b3cd3dcbb3c1b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000041ff9e30f34c8955cca8514d1570f78c54cba788b3eaa14f687f828b72278b0c5713b3b8bc8f1822513ec2da0f7cf470be788224283450c845e4bebdc3b7a612971b00000000000000000000000000000000000000000000000000000000000000"
	input                = "000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000007a000000000000000000000000000000000000000000000000000000000000007400000000000000000000000000000000000000000000000000000000000aa36a700000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000024000000000000000000000000000000000000000000000000000000000000000034b6f70ea9c9556453ab0f8b65003118239719ae504bd19559f21e0f3c5021479bac7d491529a703e5af3336c32ff64b73b0cd0ed25cc61a43567b25741dde8b6f68541762276895b200060168ccdf90abb8c621b0229739b9f1dc9b1903e20aa0000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e00000000000000000000000000000000000000000000000000000000000000013617070726f7665436f6e747261637443616c6c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000013617070726f7665436f6e747261637443616c6c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000013617070726f7665436f6e747261637443616c6c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000001e00000000000000000000000000000000000000000000000000000000000000360000000000000000000000000000000000000000000000000000000000000016000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000001000000000000000000000000001f98c06d8734d5a9ff0b53e3294626e62e4d232c2ccb86603d404ee7a1982d7dddce2416aa1e334808027e85a574fd4beb642d457c1b7e6978cb930a0e42b632773e564be64eb64da491aee447a4fa836ead8a0400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010626974636f696e2d746573746e65743400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002a30783133304334383130443537313430653145363239363763424637343243614561453931623665634500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000016000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000001000000000000000000000000001f98c06d8734d5a9ff0b53e3294626e62e4d232c70859da59f66b872df9495245c3f69a35137d3a7b7ef7b255557e3d3065c95a3a1c6f8acb05f02085139c3cd4a16c18edc55fa36cc49551c4caf611ce3f37daa00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010626974636f696e2d746573746e65743400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002a30783133304334383130443537313430653145363239363763424637343243614561453931623665634500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000016000000000000000000000000000000000000000000000000000000000000000c00000000000000000000000000000000000000000000000000000000000000100000000000000000000000000b91e3a8ef862567026d6f376c9f3d6b814ca43373542e25e3fe2e4082f9dff6769222d2a40b67eafe49660fd7edb26fffdfdab177061fd3d540a3e43f3ea5026d591ec927e13b5918d1e8d6b3c13f33faad09c1800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010626974636f696e2d746573746e65743400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002a30783234613164423537466133656341466362614439316436456630363834333961634565416530393000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000032000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000120000000000000000000000000000000000000000000000000000000000000ea6000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000000004000000000000000000000000324a5f8ff56f04a99f6af55a5de23e4f48901b7200000000000000000000000048a200f5cc43494e98b862f78ddf839ada5e08550000000000000000000000006c8a7a322bb78b4c209aa6e3713f30f5ea95a94c000000000000000000000000c28881f4cc390ad5484f008ee2c3374754160a9d00000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000009c4000000000000000000000000000000000000000000000000000000000000075300000000000000000000000000000000000000000000000000000000000004e2000000000000000000000000000000000000000000000000000000000000027100000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000c00000000000000000000000000000000000000000000000000000000000000041010be80802ab74ed3eb607339edf2c126d194d41acf6d170f34fd2dab83f75a86c636a79a0a5a7fddfb24c2410f6cb34bf7549e268856766c7238b3cd3dcbb3c1b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000041ff9e30f34c8955cca8514d1570f78c54cba788b3eaa14f687f828b72278b0c5713b3b8bc8f1822513ec2da0f7cf470be788224283450c845e4bebdc3b7a612971b00000000000000000000000000000000000000000000000000000000000000"
	inputV01             = "0000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000036000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000000015fc51b546d2c2a0b86cdf7ebc8bfd0ce55f27511c9c931dab5f151f718057b91000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000013617070726f7665436f6e747261637443616c6c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000016000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000dbf8eaa555e234d15dc3b9a4ad7320de8ebd5c0a0bd13cf894d1f6fdf73885730169c7221503474286609f3c56c5719fed501fcb1969d697c9070d23faee3c1a00000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000010657468657265756d2d7365706f6c696100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002a30784239316533413845663836323536373032366436463337366339463364366238313443613433333700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000032000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000120000000000000000000000000000000000000000000000000000000000000ea6000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000000004000000000000000000000000057cc688a7a0336897a315e38643e42ec207e2090000000000000000000000000e942c5e30adf86f844339850c5791355efd3d95000000000000000000000000a2ffff8288c4ee3bce7b26816fc606b403aca185000000000000000000000000bc57d589b69d26d6e64a9aec17eb35fbb5b158bc00000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000009c400000000000000000000000000000000000000000000000000000000000004e20000000000000000000000000000000000000000000000000000000000000271000000000000000000000000000000000000000000000000000000000000075300000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000c00000000000000000000000000000000000000000000000000000000000000041edd893617e4454ecf4b6e202f01ed5e0be19b527b70d132c3ab34aaef974ede74ffc4b9412219ec90d25211634e70052dbec52a551e6741dd0590c29f42ed05d1b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004189cdcb409d1f11eb889e25d669934997ce775cdde9edce2b54dba463ef4440ad3a9cfe7de1cf0265d1e46e57f4d9bd2901468323f56d997dead5a5fe60d760271b00000000000000000000000000000000000000000000000000000000000000"
	btcPayload           = "0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000041863484e69645038424146494341414141415136354e737a6a6c46712f584b2b384d6b6233522b554b766d3676723954446d796a714b4a475531417a6241414141414144392f2f2f2f4162674c414141414141414146674155554e7a736f56697079484c72514631534b543031455242584c4a344141414141414145424b3643474151414141414141496c45676634466176323339654549366349716f327877736b473773724a454d4131457930304c6b6d496f33754e5542417751414141414149685841554a4b62644d476753565333693074674e656c365867654b5767386f374a625652372f756d7336414f734374494258616b54732b683753544b78346268396c6d66436a6e4a5171673757437a6f784356395548685a4253497243425a546e6a416f706143454e6e425651314b30787344316553355a5a7a79396e68435344757a7772743445626f67745a3558584f2b4850716c5363362f5657566249525a425163674455454f6154354c42357043624d59514b36494f4c534a732f61374a4f515044383767614161676247524e324a38736d356947677237653831752b382f2f7569447738396d2b72336f3552627971464834454775485679674b62336e35413243556642345057374c3650746270546f734168466858616b54732b683753544b78346268396c6d66436a6e4a5171673757437a6f784356395548685a4253494a514661454b5873637059707874324750634b4c63574c686a356177446533596678574c496f516f6f7069387977414141414168466c6c4f654d43696c6f4951326346564455725447775056354c6c6c6e504c3265454a494f375043753367524a514661454b5873637059707874324750634b4c63574c686a356177446533596678574c496f516f6f70693879774141414141684672576556317a76687a3670556e4f7631566c5779455751554849413142446d6b2b53776561516d7a4745434a514661454b5873637059707874324750634b4c63574c686a356177446533596678574c496f516f6f706938797741414141416846754c534a732f61374a4f515044383767614161676247524e324a38736d356947677237653831752b382f2f4a514661454b5873637059707874324750634b4c63574c686a356177446533596678574c496f516f6f70693879774141414141684676447a32623676656a6c46764b6f55666751613464584b41707665666b44594a52384867396273766f2b314a514661454b5873637059707874324750634b4c63574c686a356177446533596678574c496f516f6f7069387977414141414142467942516b7074307761424a564c654c53324131365870654234706144796a736c745648762b36617a6f41367741455949466f51706578796c696e4733595939776f7478597547506c72414e3764682f46597369684369696d4c7a4c4141413d0000000000000000"
	executeDeployToken   = "09c5eabe000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000006800000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000034000000000000000000000000000000000000000000000000000000000000002e00000000000000000000000000000000000000000000000000000000000000061000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000000016972a4f5d1cd7a82380a96750e4f9431355448afaa8f0487b405dd142a773fe500000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000b6465706c6f79546f6b656e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000005f5e100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f4240000000000000000000000000000000000000000000000000000000000000000a5365706f6c69614274630000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000047042746300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000032000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000120000000000000000000000000000000000000000000000000000000000000177000000000000000000000000000000000000000000000000000000000000001c000000000000000000000000000000000000000000000000000000000000000040000000000000000000000001d38fbbec12e48d4c9a7209b4daa98b7a90c8b1b00000000000000000000000034bbb680ae67d362b4b81484d9cd2d3c8472708900000000000000000000000045a39ceb4f1401d1cd934cd06ba97421f15eda7800000000000000000000000057abf82ce01a477539870e012b8bf36e362d197f000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000007d000000000000000000000000000000000000000000000000000000000000003e80000000000000000000000000000000000000000000000000000000000000bb80000000000000000000000000000000000000000000000000000000000000fa00000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000000416e94a0455d1d16297da5e8f98f3cd97ffc7f90a685f07e54affe4d9a115c932d5309cdf0285c9150882844b6f8e16b445ac23082d159231713736e0f8a508efe1b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000041333db082bc606ac99d006a896640569b5b3cc92e6dd51d9e4112b4df16263e6b06cff2c8aede1249948a86fbf2be0cd36fe7f7e7603927e071235ab5663ac8c61b00000000000000000000000000000000000000000000000000000000000000"
	inputDeployToken     = "0000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000034000000000000000000000000000000000000000000000000000000000000002e00000000000000000000000000000000000000000000000000000000000000061000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000000016972a4f5d1cd7a82380a96750e4f9431355448afaa8f0487b405dd142a773fe500000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000b6465706c6f79546f6b656e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000005f5e100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f4240000000000000000000000000000000000000000000000000000000000000000a5365706f6c69614274630000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000047042746300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000032000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000120000000000000000000000000000000000000000000000000000000000000177000000000000000000000000000000000000000000000000000000000000001c000000000000000000000000000000000000000000000000000000000000000040000000000000000000000001d38fbbec12e48d4c9a7209b4daa98b7a90c8b1b00000000000000000000000034bbb680ae67d362b4b81484d9cd2d3c8472708900000000000000000000000045a39ceb4f1401d1cd934cd06ba97421f15eda7800000000000000000000000057abf82ce01a477539870e012b8bf36e362d197f000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000007d000000000000000000000000000000000000000000000000000000000000003e80000000000000000000000000000000000000000000000000000000000000bb80000000000000000000000000000000000000000000000000000000000000fa00000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000000416e94a0455d1d16297da5e8f98f3cd97ffc7f90a685f07e54affe4d9a115c932d5309cdf0285c9150882844b6f8e16b445ac23082d159231713736e0f8a508efe1b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000041333db082bc606ac99d006a896640569b5b3cc92e6dd51d9e4112b4df16263e6b06cff2c8aede1249948a86fbf2be0cd36fe7f7e7603927e071235ab5663ac8c61b00000000000000000000000000000000000000000000000000000000000000"
	CREATE_TOKEN_PAYLOAD = "6fc95b3400000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000005f5e1002377374275e65139f8b13b342d1fb862fc39ca23e76356fe24f7ca72c5ba5757000000000000000000000000000000000000000000000000000000000000000a5365706f6c69614274630000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000047042746300000000000000000000000000000000000000000000000000000000"
	EXECUTE2_DATA        = "224c9778000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000005e0000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000002a000000000000000000000000000000000000000000000000000000000000002400000000000000000000000000000000000000000000000000000000000aa36a7000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000001400000000000000000000000000000000000000000000000000000000000000001f7b59e9ab9613d8596e9be9ad31f10a51ae028008918cfdb68b8e7a624e436cc0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000096d696e74546f6b656e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000600000000000000000000000001f3b5b03366dd348421c5e29477884fcca9fcd32000000000000000000000000000000000000000000000000000000000000128500000000000000000000000000000000000000000000000000000000000000047342746300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000032000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000120000000000000000000000000000000000000000000000000000000000000177000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000000004000000000000000000000000558618a866aeadd26d64b1675f6c001d78fc059200000000000000000000000075c2caeb6718c6b9b29d0656e2ab45a09da103470000000000000000000000009822b413ad1fa6f50c257031bf3fa39bae509af3000000000000000000000000ea5fdaac9c588fd35c2cf045ba3b229643900e5800000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000fa000000000000000000000000000000000000000000000000000000000000007d000000000000000000000000000000000000000000000000000000000000003e80000000000000000000000000000000000000000000000000000000000000bb80000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000c00000000000000000000000000000000000000000000000000000000000000041cafd5fd2180d78ec0cf053d7af393e3aab9a62899fb08366481169c6651b62a733ab5df72073cbf9c248158bc32997d94d8c1f1e8cbb8fc467b6446e03d1f6811c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000414762fb75a723d6d821a73c07da28274c08d260ab2697d0811460e9a05d7b559115d7452d933f0309db9e11284efdf82a268473dfb9cfcc4b89f0329e6e36376f1b00000000000000000000000000000000000000000000000000000000000000"
)

func TestDecodeSwitchPhase(t *testing.T) {
	//MESSAGE := "0x3cf708dabae1d5c55006d827f479f2f3b1599fd66a4419568aadf695c5bb5400"
	SWITCH_PHASE_EXECUTE_DATA := "09c5eabe000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000005800000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000024000000000000000000000000000000000000000000000000000000000000001e00000000000000000000000000000000000000000000000000000000000aa36a7000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000000015dbe6eae31cbfc70bb0fca2bfe3376550796d525adfde75ca6be9f9b424ea31d00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000b737769746368506861736500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000013e79326a9493896e13af62194e694dff4c9300700407449363564b0eaeaf07e8000000000000000000000000000000000000000000000000000000000000032000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000120000000000000000000000000000000000000000000000000000000000000177000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000000004000000000000000000000000368c7ad1e199a196ec141f871934fbf5eed815bf00000000000000000000000047f08accf934f5153db2acdc3fee99230da06f99000000000000000000000000950dfec5640782d8483d86b4ad5b1d609cf5155d000000000000000000000000b0f92929e9797f21a916d7cab361450a9222a2fd000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000007d000000000000000000000000000000000000000000000000000000000000003e80000000000000000000000000000000000000000000000000000000000000fa00000000000000000000000000000000000000000000000000000000000000bb80000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000c00000000000000000000000000000000000000000000000000000000000000041effc10886571db188c404b581e794a1636a0888d37ed6b6d4152822ad0aaa9595a3f125c59d76e8953d4e6d01f8e1d2a511e1088f39078545abd16153b960dc01b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000411d96d97f35384634ba08d6610ede65e1dca83f897b8df9b9c5760b383895064413eddef3ccd8e76f743b5b74650e48ee566605c7b0f3b730827fdc93a185ce1b1c00000000000000000000000000000000000000000000000000000000000000"
	PROOF := "00000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000120000000000000000000000000000000000000000000000000000000000000177000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000000004000000000000000000000000368c7ad1e199a196ec141f871934fbf5eed815bf00000000000000000000000047f08accf934f5153db2acdc3fee99230da06f99000000000000000000000000950dfec5640782d8483d86b4ad5b1d609cf5155d000000000000000000000000b0f92929e9797f21a916d7cab361450a9222a2fd000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000007d000000000000000000000000000000000000000000000000000000000000003e80000000000000000000000000000000000000000000000000000000000000fa00000000000000000000000000000000000000000000000000000000000000bb80000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000c00000000000000000000000000000000000000000000000000000000000000041effc10886571db188c404b581e794a1636a0888d37ed6b6d4152822ad0aaa9595a3f125c59d76e8953d4e6d01f8e1d2a511e1088f39078545abd16153b960dc01b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000411d96d97f35384634ba08d6610ede65e1dca83f897b8df9b9c5760b383895064413eddef3ccd8e76f743b5b74650e48ee566605c7b0f3b730827fdc93a185ce1b1c00000000000000000000000000000000000000000000000000000000000000"
	PROOF_BYTES, err := hex.DecodeString(PROOF)
	require.NoError(t, err)
	proofArgs, err := evm.AbiUnpack(PROOF_BYTES, "address[]", "uint256[]", "uint256", "bytes[]")
	require.NoError(t, err)
	t.Logf("Proof Args %+v", proofArgs)
	decodedExecuteData, err := evm.DecodeExecuteData(SWITCH_PHASE_EXECUTE_DATA)
	assert.Nil(t, err)
	t.Logf("Input %x", decodedExecuteData.Input)
	param := decodedExecuteData.Params[0]
	args, err := evm.AbiUnpack(param, "uint8", "bytes32")
	t.Logf("Error: %+v", err)
	require.NoError(t, err)
	t.Logf("Args %+v", args)
	t.Logf("%x", args[1].([32]byte))
	t.Logf("DecodedExecuteData: %+v", decodedExecuteData)
}
func TestDeployTokenPayload(t *testing.T) {
	payload, err := hex.DecodeString(CREATE_TOKEN_PAYLOAD)
	assert.NoError(t, err)
	// input, err := evm.AbiUnpack(payload[4:], "bytes")
	// assert.NoError(t, err)
	dataDecoded, err := evm.AbiUnpack(payload[4:], "string", "string", "uint8", "uint256", "bytes32")
	assert.NoError(t, err)
	t.Logf("%T", dataDecoded[4])
	salt := dataDecoded[4].([32]uint8)
	t.Logf("SaltValue: %s", hex.EncodeToString(salt[:]))
	t.Logf("DataEcode %v", dataDecoded)
}
func TestBtcPayload(t *testing.T) {
	encodedPsbtPayload, err := hex.DecodeString(btcPayload)
	if err != nil {
		t.Error("Cannot decode payload")
	}
	decodedPsbtPayload, err := evm.AbiUnpack(encodedPsbtPayload, "string")
	if err != nil {
		t.Fatalf("[BtcClient] [executeBtcCommand] failed to abi unpack psbt: %v", err)
	}
	t.Logf("DecodedPsbtPayload: %+v", decodedPsbtPayload[0])
}
func TestInput(t *testing.T) {
	inputBytes, err := hex.DecodeString(inputV01)
	assert.Nil(t, err)
	decodedExecuteData, err := evm.DecodeInput(inputBytes)
	assert.Nil(t, err)
	assert.Equal(t, input, hex.EncodeToString(decodedExecuteData.Input))
	t.Logf("DecodedExecuteData: %+v", decodedExecuteData)
}
func TestDecodeExecuteDeployToken(t *testing.T) {
	executeData := strings.TrimPrefix(EXECUTE2_DATA, "0x")
	//executeData = strings.TrimPrefix(BIG_EXECUTE_DATA, "0x")
	decodedExecuteData, err := evm.DecodeExecuteData(executeData)
	t.Logf("decodedExecuteData: %v", decodedExecuteData)
	assert.Nil(t, err)
	if len(decodedExecuteData.Params) > 0 {
		deployToken, err := evm.DecodeDeployToken(decodedExecuteData.Params[0])
		assert.Nil(t, err)
		t.Logf("DeployToken %++v", deployToken)
	}

	assert.Equal(t, []string{"deployToken"}, decodedExecuteData.Commands)
	assert.Equal(t, len(decodedExecuteData.CommandIds), len(decodedExecuteData.Params))
	assert.Equal(t, []uint64{2000, 1000, 3000, 4000}, decodedExecuteData.Weights)
	assert.Equal(t, uint64(6000), decodedExecuteData.Threshold)
	assert.Equal(t, []string{"6e94a0455d1d16297da5e8f98f3cd97ffc7f90a685f07e54affe4d9a115c932d5309cdf0285c9150882844b6f8e16b445ac23082d159231713736e0f8a508efe1b",
		"333db082bc606ac99d006a896640569b5b3cc92e6dd51d9e4112b4df16263e6b06cff2c8aede1249948a86fbf2be0cd36fe7f7e7603927e071235ab5663ac8c61b"},
		decodedExecuteData.Signatures)

}
func TestDecodeExecuteData1(t *testing.T) {
	decodedExecuteData, err := evm.DecodeExecuteData(executeData1)
	assert.Nil(t, err)
	commandIdHexs := make([]string, len(decodedExecuteData.CommandIds))
	for i, commandId := range decodedExecuteData.CommandIds {
		commandIdHexs[i] = hex.EncodeToString(commandId[:])
	}
	expectedCommandIds := make([]string, len(commandIdHexs))
	expectedCommandIds[0] = "4b6f70ea9c9556453ab0f8b65003118239719ae504bd19559f21e0f3c5021479"
	expectedCommandIds[1] = "bac7d491529a703e5af3336c32ff64b73b0cd0ed25cc61a43567b25741dde8b6"
	t.Logf("commandIdHexs: %v", commandIdHexs)
	t.Logf("commands: %v", decodedExecuteData.Commands)
	assert.NotNil(t, decodedExecuteData)
	assert.Equal(t, uint64(0xaa36a7), decodedExecuteData.ChainId)
	//assert.Equal(t, decodedExecuteData.CommandIds, expectedCommandIds)
	assert.Equal(t, []string{"approveContractCall", "approveContractCall"}, decodedExecuteData.Commands)
	assert.Equal(t, len(decodedExecuteData.CommandIds), len(decodedExecuteData.Params))
	assert.Equal(t, []uint64{20000, 30000, 10000, 40000}, decodedExecuteData.Weights)
	assert.Equal(t, uint64(60000), decodedExecuteData.Threshold)
	assert.Equal(t, []string{"7f5509eebd9222503b3ade3e0cb7b508a46eb700e2057e7887d0de00d3e2cc3c72cd359535cf67cd59592e0fc976578794bd5395092694e4034023493a22987e1c",
		"b086cf93f7957a084380f7e911cc6e28885eec7c6132c3d19a865ffc2f6188991bacb2ca81c66bbd294e9372d6bd82a6841a833a4ec6590270fd8e6c79aa6bf81b"},
		decodedExecuteData.Signatures)
	t.Logf("decodedExecuteData: %v", decodedExecuteData)
	fmt.Printf("decodedExecuteData: %v", decodedExecuteData)
}

func TestDecodeExecuteData2(t *testing.T) {
	decodedExecuteData, _ := evm.DecodeExecuteData(executeData2)
	expectedCommandId, err := hex.DecodeString("f68541762276895b200060168ccdf90abb8c621b0229739b9f1dc9b1903e20aa")
	assert.Nil(t, err)
	assert.NotNil(t, decodedExecuteData)
	assert.Equal(t, decodedExecuteData.ChainId, uint64(11155111))
	assert.Equal(t, decodedExecuteData.CommandIds, [][32]byte{[32]byte(expectedCommandId)})
	assert.Equal(t, decodedExecuteData.Commands, []string{"approveContractCall"})
	assert.Equal(t, len(decodedExecuteData.Params), 1)
	assert.Equal(t, decodedExecuteData.Weights, []uint64{20000, 30000, 10000, 40000})
	assert.Equal(t, decodedExecuteData.Threshold, uint64(60000))
	assert.Equal(t, decodedExecuteData.Signatures, []string{"87c6ff258a853893ffb33fafa25d5fd18e40b98d6a40dc6ad3def069f2025905146d4277dfef5900489e23f071ef1e8e303e872154c5f2a7dbbf3559a544174e1c", "bcf84bfcbb26c5055ba5e3d542bbdca32c7b8444056c5d3c8a18556840394f0771b3fb2b9e064ffedd00bca2b9326c61a9e05a47594a031901c4b63b67ab5af71c"})
	t.Logf("decodedExecuteData: %+v", decodedExecuteData)
	fmt.Printf("decodedExecuteData: %v", decodedExecuteData)
}

func TestDecodeRedeemTokenData(t *testing.T) {
	executeData := "224c977800000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000c800000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000094000000000000000000000000000000000000000000000000000000000000008e00000000000000000000000000000000000000000000000000000000000aa36a7000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000000013fcdcd4c207bc8d9f9eec4ce011a73e85355aff09aac30c85d7f69405150e0d800000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000b72656465656d546f6b656e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000074000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e00000000000000000000000000000000000000000000000000000000000000140000000000000000000000000000000000000000000000000000000000000070000000000000000000000000000000000000000000000000000000000000012850000000000000000000000000000000000000000000000000000000000000009626974636f696e7c340000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002a3078443363343034373034626244383039303238333144393966343264663132433437423342393838370000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005a0000000000000000000000000000000000000000000000000000000000000128500000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000042000000000000000000000000000000000000000000000000000000000000004e03fcdcd4c207bc8d9f9eec4ce011a73e85355aff09aac30c85d7f69405150e0d80000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000500000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000000000000000001a0000000000000000000000000000000000000000000000000000000000000022000000000000000000000000000000000000000000000000000000000000002a000000000000000000000000000000000000000000000000000000000000000423078373337376362613333366366663665306433393437383732323436633939666438303935303533663138646162323961613763366330363233643137633035320000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000042307833323465346437323638623062363562613666643731333539623634363061383261396661653137616637343334623438616436333265323033313536623735000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004230783764326233326537666438326436633831393662303161323166616266353765353431666637636234623966353062323738353964386337363639623566616100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000423078653439393237666532313066626237333961626266333539343538356534376361346362623830323165656363363732616535303961336434366562396639340000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000042307831326530626662393962306138643530626138313461383464623234653935333530393331316331343139636166646464383631326566633839393462346336000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000500000000000000000000000000000000000000000000000000000000000003e800000000000000000000000000000000000000000000000000000000000003e80000000000000000000000000000000000000000000000000000000000000458000000000000000000000000000000000000000000000000000000000000053300000000000000000000000000000000000000000000000000000000000003e800000000000000000000000000000000000000000000000000000000000000047342746300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000032000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000120000000000000000000000000000000000000000000000000000000000000177000000000000000000000000000000000000000000000000000000000000001c000000000000000000000000000000000000000000000000000000000000000040000000000000000000000007b3c131ffaa389e85d06ba7da27a0b21542c8ed60000000000000000000000008cbb0b8512a27e6e6a59e77e61f9807288740ea50000000000000000000000009f6e6227adc56dcb54d9235fcd43a3cfc04bac55000000000000000000000000ea7121e51b8328747584dc8efc67397d2dd6344b000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000007d000000000000000000000000000000000000000000000000000000000000003e80000000000000000000000000000000000000000000000000000000000000bb80000000000000000000000000000000000000000000000000000000000000fa00000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000000410dcf40fa7a9d1b3f9ce3800947ac9f16f0c9f848758c0005b4be2b3e84b764d04592c2ccabb38ddc1c0a11c36ef5df3325ca54432af9af7ac72c027870d7a2221b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000041ac746e0b44f545c1f7893664a7f575f3da93c760f322482039dd29bbf67151c5717d51191a90bb239f9d47263ea848f1aa4b65b7eaf2225f8e596464a50748ec1b00000000000000000000000000000000000000000000000000000000000000"
	decodedExecuteData, err := evm.DecodeExecuteData(executeData)
	assert.Nil(t, err)
	assert.Equal(t, decodedExecuteData.ChainId, uint64(11155111))
	assert.Equal(t, decodedExecuteData.Commands, []string{"redeemToken"})
	commandIds := []string{}
	for _, commandId := range decodedExecuteData.CommandIds {
		commandIds = append(commandIds, hex.EncodeToString(commandId[:]))
	}
	t.Logf("commandIds: %v", commandIds)
	t.Logf("params: %v", decodedExecuteData.Params)
	t.Logf("signatures: %v", decodedExecuteData.Signatures)

	t.Logf("commandIds: %v", commandIds)
	t.Logf("weights: %v", decodedExecuteData.Weights)
	t.Logf("threshold: %v", decodedExecuteData.Threshold)
	t.Logf("operators: %v", decodedExecuteData.Operators)
	//Parse redeemToken params
	redeemTokenParams, err := evm.AbiUnpack(decodedExecuteData.Params[0], "string", "string", "bytes", "string", "uint256")
	if err != nil {
		t.Fatalf("failed to unpack proof: %v", err)
	}
	t.Logf("redeemTokenParams: %v", redeemTokenParams)
}
